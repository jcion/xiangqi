<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xiangqi (Chinese Chess)</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Xiangqi (Chinese Chess)</h1>
    <div class="game-container">
        <div class="board" id="board"></div>
        <div class="controls">
            <button id="newGame">New Game</button>
            <button id="undoMove">Undo Move</button>
            <button id="aiToggle">AI Opponent: OFF</button>
            <button id="instructionsBtn">Instructions</button>
        </div>
    </div>
    <div class="game-info" id="gameInfo">Red's Turn</div>

    <!-- Instructions Modal -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Xiangqi (Chinese Chess) Instructions</h2>
            
            <h3>Basic Rules</h3>
            <p>Xiangqi is a two-player strategy board game played on a 9×10 grid with pieces placed on the intersections. The objective is to capture the opponent's General (similar to checkmate in Western chess).</p>
            <p>Red moves first, followed by Black, with players alternating turns. A piece is captured when an opponent's piece moves onto its position.</p>
            
            <h3>Pieces and Their Movements</h3>
            
            <div class="piece-info">
                <div class="piece-icon">♚</div>
                <div class="piece-description">
                    <h3>General (King)</h3>
                    <p>Moves one point horizontally or vertically, but cannot leave the palace (3×3 grid). Generals cannot face each other directly with no pieces in between (the "flying general" rule).</p>
                </div>
            </div>
            
            <div class="piece-info">
                <div class="piece-icon">♝</div>
                <div class="piece-description">
                    <h3>Advisor (Minister)</h3>
                    <p>Moves one point diagonally and must stay within the palace.</p>
                </div>
            </div>
            
            <div class="piece-info">
                <div class="piece-icon">♘</div>
                <div class="piece-description">
                    <h3>Elephant</h3>
                    <p>Moves exactly two points diagonally. Cannot jump over pieces at the intervening point. Cannot cross the river.</p>
                </div>
            </div>
            
            <div class="piece-info">
                <div class="piece-icon">♞</div>
                <div class="piece-description">
                    <h3>Horse</h3>
                    <p>Moves one point horizontally or vertically, then one point diagonally outward (similar to a Knight in chess). Cannot jump over pieces.</p>
                </div>
            </div>
            
            <div class="piece-info">
                <div class="piece-icon">♜</div>
                <div class="piece-description">
                    <h3>Chariot (Rook)</h3>
                    <p>Moves any distance horizontally or vertically, but cannot jump over pieces.</p>
                </div>
            </div>
            
            <div class="piece-info">
                <div class="piece-icon">♛</div>
                <div class="piece-description">
                    <h3>Cannon</h3>
                    <p>Moves like the Chariot, but must jump over exactly one piece (of either color) to capture. For non-capturing moves, it moves like a Chariot without jumping.</p>
                </div>
            </div>
            
            <div class="piece-info">
                <div class="piece-icon">♟</div>
                <div class="piece-description">
                    <h3>Soldier (Pawn)</h3>
                    <p>Moves one point forward. After crossing the river, it can also move one point horizontally. Cannot move backward.</p>
                </div>
            </div>
            
            <h3>Special Rules</h3>
            <p><strong>Perpetual Check:</strong> Continuously putting the opponent's General in check is not allowed.</p>
            <p><strong>Perpetual Chase:</strong> Continuously chasing a piece in a repeating pattern is not allowed.</p>
            <p><strong>Stalemate:</strong> A player with no legal moves results in a loss (unlike western chess where it's a draw).</p>
        </div>
    </div>

    <!-- Load JavaScript files in the correct order -->
    <script src="config.js"></script>
    <script src="utils.js"></script>
    <script src="state.js"></script>
    <script src="board.js"></script>
    <script src="gameMechanics.js"></script>
    <script src="aiLogic.js"></script>
    <script src="events.js"></script>

    <!-- Initialize the game when the page loads -->
    <script>
        // Get DOM elements
        const boardElement = document.getElementById('board');
        const newGameButton = document.getElementById('newGame');
        const undoMoveButton = document.getElementById('undoMove');
        const aiToggleButton = document.getElementById('aiToggle');
        const instructionsButton = document.getElementById('instructionsBtn');
        const instructionsModal = document.getElementById('instructionsModal');
        const closeModalButton = document.querySelector('.close');
        const gameInfoElement = document.getElementById('gameInfo');

        // Start the game when the page loads
        window.addEventListener('DOMContentLoaded', () => {
                initGame();
        });
    </script>
</body>
</html>